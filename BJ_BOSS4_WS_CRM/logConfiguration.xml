<?xml version="1.0" encoding="UTF-8"?>

<!--
  Configuration for Borland Enterprise Server partition logging
  Uses log4j 1.2
-->
<!-- "threshold" is the most course grained filter for controlling what's logged.
     "debug" turns on log4j's own internal debugging.
-->
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/" threshold="all" debug="false">
    <!-- Primary appender used for logging in a correctly configured and running system -->
    <appender name="PRIMARY" class="org.apache.log4j.RollingFileAppender">
        <errorHandler class="org.apache.log4j.varia.FallbackErrorHandler">
            <root-ref/>
            <appender-ref ref="FALLBACK"/>
        </errorHandler>
        <param name="Threshold" value="ALL"/>
        <!-- levels this appender emits -->
        <param name="File" value="adm/logs/partition_log.txt"/>
        <param name="Append" value="true"/>
        <param name="ImmediateFlush" value="true"/>
        <param name="BufferedIO" value="false"/>
        <param name="BufferSize" value="8192"/>
        <param name="MaxBackupIndex" value="9"/>
        <param name="MaxFileSize" value="5MB"/>
        <param name="Encoding" value="GBK"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d %-5p %x - %m%n"/>
        </layout>
    </appender>
    <!-- Fallback appender used when primary appender encounters an error -->
    <appender name="FALLBACK" class="org.apache.log4j.ConsoleAppender">
        <param name="Threshold" value="ALL"/>
        <!-- levels this appender emits -->
        <param name="ImmediateFlush" value="true"/>
        <param name="Target" value="System.out"/>
        <!-- <param name="Encoding" value="UTF-8"/> -->
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d %-5p %x - %m%n"/>
        </layout>
    </appender>
    <!-- Appender for streaming to a socket (for example, chainsaw) -->
    <appender name="SOCKET" class="org.apache.log4j.net.SocketAppender">
        <param name="locationInfo" value="false"/>
        <param name="Threshold" value="ALL"/>
        <!-- levels this appender emits -->
        <param name="Port" value="4445"/>
        <!-- the default - change on unix to avoid conflicts -->
        <param name="RemoteHost" value="localhost"/>
        <param name="ReconnectionDelay" value="30000"/>
        <!-- milliseconds -->
    </appender>
    <!--
    <logger name="com.borland.enterprise.foo.bar" additivity="true">
      <level value="DEBUG" />
    </logger>
    -->
    <!-- change log4j to use Async IO -->  
    <appender name="ASYNC_LOGFILE" class="org.apache.log4j.AsyncAppender"> 
        <param name="BufferSize" value="8192"/>  
        <appender-ref ref="PRIMARY"/> 
    </appender>  
    <root>
        <level value="INFO"/>
        <appender-ref ref="ASYNC_LOGFILE"/>
        <!-- <appender-ref ref="SOCKET"/>   Uncomment to turn on the socket appender -->
    </root>
    <logger name="com.asiainfo" additivity="false"> 
        <level value="DEBUG"/>  
        <appender-ref ref="ASYNC_LOGFILE"/>
    </logger>  
    <logger name="org.hibernate" additivity="false"> 
        <level value="WARN"/>  
        <appender-ref ref="ASYNC_LOGFILE"/>
    </logger>  
    <logger name="org.hibernate.type" additivity="false"> 
        <level value="DEBUG"/>  
        <appender-ref ref="ASYNC_LOGFILE"/>
    </logger> 
</log4j:configuration>
